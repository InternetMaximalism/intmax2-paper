As the blockchain ecosystem continually evolves, so does the urgency for blockchain scaling solutions that preserve security, reduce transaction costs, and improve overall throughput. Layer 2 technologies, particularly rollups, have emerged as pivotal tools to overcome these challenges, and have thus gathered substantial attention. Among these, Zero-Knowledge rollups (or ZK-rollups) have shown great promise due to their unique capability to bundle numerous transactions into a single proof that can be verified quickly and cheaply onchain. Existing ZK-rollups, while managing to move computation costs away from the underlying Layer 1 (L1) blockchain, are still limited by the fact that all necessary data for verifying users' balances have to be posted on L1. This data, in a typical scenario, includes the transaction sender, the index of the token, the amount, and the recipient for each transaction, thus limiting the number of transactions per second that can be supported by the rollup.

\subsection{Data Availability}

A fundamental bottleneck for blockchains is what is known as data availability. Data availability means that transaction data needs to be available in order to be able to prove the current state, such as account balances, of the blockchain. This is a problem for both Layer 1 blockchains and rollups. Layer 1 blockchains usually achieve data availability by requiring that all transaction data is publicly available for a node to consider the blockchain valid. Rollups achieve data availability by leveraging the data availability of the underlying blockchain and require that all transaction data is posted to L1 (e.g. using calldata or blob data on Ethereum). Because this data needs to be replicated among a large set of nodes, there is a limit on how much data can be made available, which limits the number of transactions per second that the blockchain or the rollup can support. While for smart contract blockchains it might be necessary to provide the complete transaction data, it turns out that for simple payment transactions it is only necessary to make available a commitment to the set of transactions in a block (such as a Merkle tree root), together with the set of senders who have signed the commitment, confirming that they have received inclusion proofs of their transactions. Users can then generate Zero-Knowledge proofs (ZK-proofs) of their own balances by combining the inclusion proofs of their sent transactions with the inclusion proofs and ZK-proofs of sufficient balance of each received transaction, which is provided by the transaction sender offchain. Our rollup design uses this method to achieve increased throughput compared to existing alternatives. In addition, the design allows permissionless block building that can happen in parallel, without needing any leader election or any coordination between the block builders. Since the block builders do not verify the validity of the transactions, they can be fully stateless, allowing a very simple and censorship resistant rollup design.

\subsection{Our Contributions}

Intmax2 is an efficient and stateless rollup design that:

\begin{itemize}
  \setlength\itemsep{0.35em}

    \item Only posts the index\footnote{This can be as low as 4-6 bytes without compression, depending on the number of users in the system.} of each transaction sender, as well as a merkle tree root and an aggregated signature of it for each batch on L1.

    \item Allows senders to transfer an unlimited number of tokens to an unlimited number of recipients while using a fixed 4-6 bytes data consumption.

    %MY: maybe change phrasing
    \item Shifts the computational requirements from the aggregator to the client, making it highly scalable with the number of users.

    \item Offers permissionless block production.

    \item Provides stronger privacy properties than traditional ZK-rollups.
  
\end{itemize}

\subsection{Our Design}

We divide the description of our design into four parts.

\smallbreak
First, in \Cref{section:transaction-map-sequences} we define a simple blockchain where all transaction data is public, and where everyone can verify the balance of every account.
\smallbreak
Second, in \Cref{section:balance-proofs} we show how users can prove their balances in a smaller blockchain whose blocks consists of commitments to a set of transactions (e.g. merkle roots) together with the set of senders who have signed the commitment in the block. For simplicity, we first show how users can construct explicit balance proofs of their balances, and then replace the explicit proofs with recursive ZK-proofs~\cite{supernova,nova,plonky2}, which results in a much more efficient approach.
\smallbreak
Third, in \Cref{section:signatures} we describe how we leverage BLS signatures to verify that each sender has signed the commitment in each block. This involves defining three block types (i.e., transfer, deposit, and registration). We will also define the set of rollup accounts which includes special accounts used for withdrawing funds to the underlying blockchain.
\smallbreak
Finally, in \Cref{section:rollup-contract} we turn our design into a rollup by deploying a rollup contract on an underlying blockchain. We describe the rollup contract and its functions, i.e. how to add blocks, how to deposit funds, and how to perform withdrawals. We highlight that this process is completely open and, therefore, decentralized. As a result, any system entity is able to perform these actions.

\smallbreak

We believe that this represents a proper breakdown of the protocol and allows for a clean and incremental description of our design.